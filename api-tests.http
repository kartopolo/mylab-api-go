### MyLab API Tests
### Use REST Client extension in VS Code (humao.rest-client)
### Or Thunder Client extension (rangav.vscode-thunder-client)

@baseUrl = http://localhost:18080
@token = <paste-jwt-token-here>

################################################################################
### Health & Observability
################################################################################

### Health Check (Public)
GET {{baseUrl}}/healthz

### Ready Check (Public)
GET {{baseUrl}}/readyz

### Metrics (Public)
GET {{baseUrl}}/metrics

################################################################################
### Authentication
################################################################################

### Login - Success
POST {{baseUrl}}/v1/auth/login
Content-Type: application/json

{
  "email": "admin@example.com",
  "password": "password123"
}

### Login - Invalid Credentials
POST {{baseUrl}}/v1/auth/login
Content-Type: application/json

{
  "email": "admin@example.com",
  "password": "wrongpassword"
}

### Login - Missing Fields
POST {{baseUrl}}/v1/auth/login
Content-Type: application/json

{
  "email": ""
}

### Login - Case Insensitive Email
POST {{baseUrl}}/v1/auth/login
Content-Type: application/json

{
  "email": "ADMIN@EXAMPLE.COM",
  "password": "password123"
}

################################################################################
### Pasien (Patient) - Generic CRUD
################################################################################

### Create Pasien
POST {{baseUrl}}/v1/crud/pasien
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "nm_ps": "John Doe",
  "jk": "L",
  "tgl_lahir": "1990-01-01T00:00:00Z",
  "alamat": "Jakarta",
  "no_hp": "08123456789",
  "email": "john@example.com"
}

### Get Pasien by ID
GET {{baseUrl}}/v1/crud/pasien/0000001
Authorization: Bearer {{token}}

### Update Pasien
PUT {{baseUrl}}/v1/crud/pasien/0000001
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "nm_ps": "John Doe Updated",
  "alamat": "Jakarta Selatan"
}

### Delete Pasien
DELETE {{baseUrl}}/v1/crud/pasien/0000001
Authorization: Bearer {{token}}

################################################################################
### Pasien Select (Generic CRUD)
################################################################################

### Select All Pasien (Page 1)
POST {{baseUrl}}/v1/crud/pasien/select
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "page": 1,
  "per_page": 10
}

### Select Pasien with Filter (Name contains "John")
POST {{baseUrl}}/v1/crud/pasien/select
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "like": {"nm_ps": "John"},
  "page": 1,
  "per_page": 10
}

### Select Pasien with Multiple Filters
POST {{baseUrl}}/v1/crud/pasien/select
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "where": {"jk": "L"},
  "like": {"alamat": "Jakarta"},
  "order_by": [{"field": "nm_ps", "dir": "asc"}],
  "page": 1,
  "per_page": 20
}

################################################################################
### Error Cases
################################################################################

### Unauthorized - Missing Authorization Header
GET {{baseUrl}}/v1/crud/pasien/0000001

### Unauthorized - Invalid Authorization Header
GET {{baseUrl}}/v1/crud/pasien/0000001
Authorization: Bearer invalid

### Not Found
GET {{baseUrl}}/v1/crud/pasien/NOTEXIST
Authorization: Bearer {{token}}

### Validation Error - Invalid JSON
POST {{baseUrl}}/v1/crud/pasien
Authorization: Bearer {{token}}
Content-Type: application/json

{invalid json}
